<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Water Monitoring System</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <i class="fas fa-water"></i>
                <h1>WaterWatch</h1>
            </div>
            <button class="sidebar-close" id="sidebarClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="user-profile">
            <div class="profile-image">
                <i class="fas fa-user-circle"></i>
            </div>
            <div class="profile-info">
                <h3>Welcome</h3>
                <p class="user-name">Guest User</p>
            </div>
        </div>

        <nav class="sidebar-nav">
            <ul>
                <li>
                    <a href="index.html">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                    </a>
                </li>
                <li>
                    <a href="#" class="submenu-toggle active">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                        <i class="fas fa-chevron-right"></i>
                    </a>
                    <ul class="submenu active">
                        <li><a href="#" class="active">Water Quality</a></li>
                        <li><a href="farm-view.html">Farm Management</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#" class="submenu-toggle">
                        <i class="fas fa-chart-bar"></i>
                        <span>Analytics</span>
                        <i class="fas fa-chevron-right"></i>
                    </a>
                    <ul class="submenu">
                        <li><a href="water-usage.html">Water Usage</a></li>
                        <li><a href="pump-stats.html">Pump Stats</a></li>
                        <li><a href="#">Reports</a></li>
                    </ul>
                </li>
                <li>
                    <a href="#" class="submenu-toggle">
                        <i class="fas fa-bell"></i>
                        <span>Alerts</span>
                        <i class="fas fa-chevron-right"></i>
                    </a>
                    <ul class="submenu">
                        <li><a href="#">Notifications</a></li>
                        <li><a href="#">Alert Settings</a></li>
                    </ul>
                </li>
                <li>
                    <a href="about.html">
                        <i class="fas fa-info-circle"></i>
                        <span>About</span>
                    </a>
                </li>
                <li>
                    <a href="contact.html">
                        <i class="fas fa-envelope"></i>
                        <span>Contact</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Topbar with sidebar toggle -->
        <div class="topbar">
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="dashboard-nav">
                <h2>Dashboard</h2>
                <div class="monitoring-status">
                    <span id="monitoringIndicator">
                        <i class="fas fa-circle"></i>
                        Monitoring Active
                    </span>
                </div>
            </div>
        </div>

        <!-- Enhanced Dashboard Cards Section -->
        <div class="dashboard-cards">
            <div class="stat-card" data-card-id="water-usage">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #2196F3, #1976D2);">
                        <i class="fas fa-tint"></i>
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn" onclick="editCard('water-usage')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="card-action-btn" onclick="deleteCard('water-usage')" title="Delete">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <h3 class="card-title">Total Water Used Today</h3>
                    <p class="card-value" id="waterUsedToday">12,450 L</p>
                    <div class="card-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 68%; background: linear-gradient(90deg, #2196F3, #64B5F6);"></div>
                        </div>
                        <span class="progress-label">68% of daily target</span>
                    </div>
                    <div class="card-footer">
                        <span class="card-trend positive">
                            <i class="fas fa-arrow-up"></i> 12% from yesterday
                        </span>
                    </div>
                </div>
            </div>

            <div class="stat-card" data-card-id="active-fields">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #4CAF50, #388E3C);">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn" onclick="editCard('active-fields')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="card-action-btn" onclick="deleteCard('active-fields')" title="Delete">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <h3 class="card-title">Active Fields</h3>
                    <p class="card-value" id="activeFields">12/15</p>
                    <div class="card-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 80%; background: linear-gradient(90deg, #4CAF50, #66BB6A);"></div>
                        </div>
                        <span class="progress-label">80% fields operational</span>
                    </div>
                    <div class="card-footer">
                        <span class="card-trend">
                            <i class="fas fa-check-circle"></i> 3 fields harvested
                        </span>
                    </div>
                </div>
            </div>

            <div class="stat-card" data-card-id="moisture-avg">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #FF9800, #F57C00);">
                        <i class="fas fa-droplet"></i>
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn" onclick="editCard('moisture-avg')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="card-action-btn" onclick="deleteCard('moisture-avg')" title="Delete">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <h3 class="card-title">Moisture Average</h3>
                    <p class="card-value" id="moistureAvg">58%</p>
                    <div class="card-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 58%; background: linear-gradient(90deg, #FF9800, #FFB74D);"></div>
                        </div>
                        <span class="progress-label">Optimal range: 50-70%</span>
                    </div>
                    <div class="card-footer">
                        <span class="card-trend">
                            <i class="fas fa-info-circle"></i> Within normal range
                        </span>
                    </div>
                </div>
            </div>

            <div class="stat-card" data-card-id="pending-irrigation">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #9C27B0, #7B1FA2);">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn" onclick="editCard('pending-irrigation')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="card-action-btn" onclick="deleteCard('pending-irrigation')" title="Delete">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <h3 class="card-title">Pending Irrigations</h3>
                    <p class="card-value" id="pendingIrrigation">5</p>
                    <div class="card-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 38%; background: linear-gradient(90deg, #9C27B0, #BA68C8);"></div>
                        </div>
                        <span class="progress-label">5 of 13 remaining today</span>
                    </div>
                    <div class="card-footer">
                        <span class="card-trend warning">
                            <i class="fas fa-exclamation-triangle"></i> 2 urgent
                        </span>
                    </div>
                </div>
            </div>

            <div class="stat-card" data-card-id="weather-update">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #FFC107, #FFA000);">
                        <i class="fas fa-cloud-sun"></i>
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn" onclick="editCard('weather-update')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="card-action-btn" onclick="deleteCard('weather-update')" title="Delete">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <h3 class="card-title">Weather Update</h3>
                    <p class="card-value" id="currentWeather">Partly Cloudy</p>
                    <div class="weather-details-grid">
                        <div class="weather-item">
                            <i class="fas fa-temperature-high"></i>
                            <span>25°C</span>
                        </div>
                        <div class="weather-item">
                            <i class="fas fa-tint"></i>
                            <span>65%</span>
                        </div>
                        <div class="weather-item">
                            <i class="fas fa-wind"></i>
                            <span>12 km/h</span>
                        </div>
                        <div class="weather-item">
                            <i class="fas fa-eye"></i>
                            <span>10 km</span>
                        </div>
                    </div>
                    <div class="card-footer">
                        <span class="card-trend">
                            <i class="fas fa-cloud-rain"></i> Rain expected tomorrow
                        </span>
                    </div>
                </div>
            </div>

            <div class="stat-card" data-card-id="power-consumption">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(135deg, #F44336, #D32F2F);">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="card-actions">
                        <button class="card-action-btn" onclick="editCard('power-consumption')" title="Edit">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="card-action-btn" onclick="deleteCard('power-consumption')" title="Delete">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <h3 class="card-title">Power Consumption</h3>
                    <p class="card-value" id="powerConsumption">23.5 kWh</p>
                    <div class="card-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 47%; background: linear-gradient(90deg, #F44336, #EF5350);"></div>
                        </div>
                        <span class="progress-label">47% of daily budget</span>
                    </div>
                    <div class="card-footer">
                        <span class="card-trend negative">
                            <i class="fas fa-arrow-down"></i> 5% less than yesterday
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Grid Section -->
        <div class="dashboard-grid">
            <!-- Weather and Map Section -->
            <div class="grid-box wide">
                <div class="box-header">
                    <h2>Farm Overview</h2>
                    <div class="box-actions">
                        <button class="btn-action" id="refreshMap">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="btn-action" id="expandMap">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                <div class="map-container">
                    <div id="farmMap"></div>
                    <div class="weather-overlay">
                        <div class="current-weather">
                            <i class="fas fa-sun"></i>
                            <div class="weather-details">
                                <h3>Current Weather</h3>
                                <p class="temp">22°C</p>
                                <p class="condition">Sunny</p>
                            </div>
                        </div>
                        <div class="weather-forecast">
                            <!-- Forecast items will be added dynamically -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Water Quality Section -->
            <div class="grid-box">
                <div class="box-header">
                    <h2>Water Quality</h2>
                    <div class="box-actions">
                        <button class="btn-action active" data-period="day">Day</button>
                        <button class="btn-action" data-period="week">Week</button>
                        <button class="btn-action" data-period="month">Month</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="waterQualityChart"></canvas>
                </div>
                <div class="parameters-list">
                    <div class="parameter">
                        <span class="param-name">pH Level</span>
                        <span class="param-value">7.2</span>
                        <div class="param-indicator safe"></div>
                    </div>
                    <div class="parameter">
                        <span class="param-name">TDS</span>
                        <span class="param-value">450 ppm</span>
                        <div class="param-indicator warning"></div>
                    </div>
                </div>
            </div>

            <!-- Irrigation Schedule -->
            <div class="grid-box">
                <div class="box-header">
                    <h2>Irrigation Schedule</h2>
                    <div class="box-actions">
                        <button class="btn-action" onclick="window.location.href='irrigation-schedule.html'">
                            <i class="fas fa-calendar-alt"></i> View All
                        </button>
                    </div>
                </div>
                <div class="schedule-container" id="scheduleContainer">
                    <!-- Schedule items will be added dynamically -->
                </div>
            </div>

            <!-- Crop Management Section -->
            <div class="grid-box wide crop-management-section">
                <div class="box-header">
                    <h2>Crop Management</h2>
                    <div class="box-actions">
                        <div class="search-container">
                            <i class="fas fa-search"></i>
                            <input type="text" id="cropSearch" placeholder="Search crops...">
                        </div>
                        <button class="btn-action" id="addCropBtn">
                            <i class="fas fa-plus"></i> Add New Crop
                        </button>
                    </div>
                </div>

                <!-- Crop Selection Modal -->
                <div class="modal" id="cropModal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3>Add New Crop</h3>
                            <button class="modal-close"><i class="fas fa-times"></i></button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label>Select Crop</label>
                                <select id="cropType" class="form-control">
                                    <option value="">Choose a crop...</option>
                                    <option value="wheat">Wheat</option>
                                    <option value="rice">Rice</option>
                                    <option value="corn">Corn</option>
                                    <option value="potato">Potato</option>
                                    <option value="tomato">Tomato</option>
                                    <option value="soybean">Soybean</option>
                                    <option value="cotton">Cotton</option>
                                    <option value="sugarcane">Sugarcane</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Land Area</label>
                                <div class="input-group">
                                    <input type="number" id="landArea" class="form-control" min="0" step="0.1">
                                    <select id="areaUnit" class="form-control unit-select">
                                        <option value="hectare">Hectares</option>
                                        <option value="acre">Acres</option>
                                        <option value="sqm">Square Meters</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Soil Type</label>
                                <select id="soilType" class="form-control">
                                    <option value="">Select soil type...</option>
                                    <option value="loamy">Loamy</option>
                                    <option value="sandy">Sandy</option>
                                    <option value="clay">Clay</option>
                                    <option value="silt">Silty</option>
                                </select>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn-secondary">Cancel</button>
                            <button class="btn-primary">Add Crop</button>
                        </div>
                    </div>
                </div>

                <!-- Crop Cards Container -->
                <div class="crop-cards-container">
                    <!-- Example of a detailed crop card -->
                    <div class="crop-detail-card">
                        <div class="crop-header">
                            <div class="crop-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="crop-title">
                                <h3>Wheat</h3>
                                <span class="crop-area">5.2 Hectares</span>
                            </div>
                            <div class="crop-actions">
                                <button class="btn-icon"><i class="fas fa-edit"></i></button>
                                <button class="btn-icon"><i class="fas fa-trash-alt"></i></button>
                            </div>
                        </div>
                        
                        <div class="crop-info-grid">
                            <div class="info-item">
                                <span class="label">Soil Type</span>
                                <span class="value">Loamy</span>
                                <span class="recommendation good">Ideal Match</span>
                            </div>
                            <div class="info-item">
                                <span class="label">Water Need</span>
                                <span class="value">2.5L/m²</span>
                                <div class="water-meter">
                                    <div class="meter-fill" style="width: 75%"></div>
                                </div>
                            </div>
                            <div class="info-item">
                                <span class="label">Weather Impact</span>
                                <span class="value">Optimal</span>
                                <span class="weather-note">Current conditions are favorable</span>
                            </div>
                        </div>

                        <div class="crop-recommendations">
                            <h4>Recommendations</h4>
                            <ul class="recommendation-list">
                                <li class="recommendation-item">
                                    <i class="fas fa-tint"></i>
                                    <span>Increase irrigation by 0.5L/m² due to high temperature</span>
                                </li>
                                <li class="recommendation-item">
                                    <i class="fas fa-cloud-sun"></i>
                                    <span>Best watering time: Early morning (6:00 AM - 8:00 AM)</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- Add more crop cards here -->
                </div>
            </div>
        </div>
    </main>

    <script src="js/dashboard.js"></script>
    <script src="js/sidebar.js"></script>
</body>
</html>